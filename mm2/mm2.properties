###################################################################
# MirrorMaker2 - Configuración completa y correcta
###################################################################

# Clusters declarados
clusters = origin, destination

# ---------------------------------------------------------------
# Cluster ORIGEN
# ---------------------------------------------------------------
origin.bootstrap.servers = kafka-origin:9092
origin.security.protocol = SASL_PLAINTEXT
origin.sasl.mechanism = PLAIN
origin.sasl.jaas.config = org.apache.kafka.common.security.plain.PlainLoginModule required \
  username="admin" \
  password="admin-secret";

origin.consumer.auto.offset.reset = earliest
origin.alias = origin

# ---------------------------------------------------------------
# Cluster DESTINO
# ---------------------------------------------------------------
destination.bootstrap.servers = kafka-dest:9092
destination.security.protocol = SASL_PLAINTEXT
destination.sasl.mechanism = PLAIN
destination.sasl.jaas.config = org.apache.kafka.common.security.plain.PlainLoginModule required \
  username="admin" \
  password="admin-secret";

destination.alias = destination

# ---------------------------------------------------------------
# Replicación principal
# ---------------------------------------------------------------
origin->destination.enabled = true

# Replicar TODO
origin->destination.topics = .*

# Mantener nombre (sin prefijo)
replication.policy.class = org.apache.kafka.connect.mirror.IdentityReplicationPolicy

# ---------------------------------------------------------------
# Topics internos (OBLIGATORIOS)
# ---------------------------------------------------------------
config.storage.topic = mm2-config.internal
offset.storage.topic = mm2-offset.internal
status.storage.topic = mm2-status.internal

config.storage.replication.factor = 1
offset.storage.replication.factor = 1
status.storage.replication.factor = 1

# Donde se crean checkpoints y syncs
checkpoints.topic.location = destination
offset-syncs.topic.location = destination

# ---------------------------------------------------------------
# Consumer / Producer config
# ---------------------------------------------------------------
consumer.security.protocol = SASL_PLAINTEXT
consumer.sasl.mechanism = PLAIN
consumer.sasl.jaas.config = org.apache.kafka.common.security.plain.PlainLoginModule required \
  username="admin" \
  password="admin-secret";

producer.security.protocol = SASL_PLAINTEXT
producer.sasl.mechanism = PLAIN
producer.sasl.jaas.config = org.apache.kafka.common.security.plain.PlainLoginModule required \
  username="admin" \
  password="admin-secret";

# ---------------------------------------------------------------
# Logging / errores
# ---------------------------------------------------------------
errors.tolerance = all
errors.log.enable = true
errors.deadletterqueue.topic.name = mm2-dlq
errors.deadletterqueue.context.headers.enable = true

tasks.max = 1
